<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Health Desk Agent - Full</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container p-4">
<h1 class="mb-3">ðŸŽ§ Health Desk Agent</h1>
<div class="mb-3">
<input id="msg" class="form-control" placeholder="Ask something...">
<button class="btn btn-primary mt-2" onclick="send()">Send</button>
<button class="btn btn-success mt-2" onclick="startVoice()">ðŸŽ¤ Speak</button>
</div>
<p id="reply"></p>

<script>
async function send(){
    const msg=document.getElementById('msg').value;
    const res=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:msg})});
    const data=await res.json();
    document.getElementById('reply').innerText=data.reply;
    const utter=new SpeechSynthesisUtterance(data.reply);
    speechSynthesis.speak(utter);
}

function startVoice(){
    const recognition=new(window.SpeechRecognition||window.webkitSpeechRecognition)();
    recognition.lang='en-US';
    recognition.start();
    recognition.onresult=async function(e){
        const msg=e.results[0][0].transcript;
        document.getElementById('msg').value=msg;
        send();
    }
}
</script>
</body>
</html>
